<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-writeup/TolkienRing/wireshark_practice">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Wireshark Practice | SANS Holiday Hack Challenge 2022</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://github.com/kringlecon-2022/writeup/TolkienRing/wireshark_practice"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Wireshark Practice | SANS Holiday Hack Challenge 2022"><meta data-rh="true" name="description" content="Use the Wireshark Phishing terminal in the Tolkien Ring to solve the mysteries around the suspicious PCAP. Get hints for this challenge by typing hint in the upper panel of the terminal."><meta data-rh="true" property="og:description" content="Use the Wireshark Phishing terminal in the Tolkien Ring to solve the mysteries around the suspicious PCAP. Get hints for this challenge by typing hint in the upper panel of the terminal."><link data-rh="true" rel="icon" href="/kringlecon-2022/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://github.com/kringlecon-2022/writeup/TolkienRing/wireshark_practice"><link data-rh="true" rel="alternate" href="https://github.com/kringlecon-2022/writeup/TolkienRing/wireshark_practice" hreflang="en"><link data-rh="true" rel="alternate" href="https://github.com/kringlecon-2022/writeup/TolkienRing/wireshark_practice" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/kringlecon-2022/blog/rss.xml" title="SANS Holiday Hack Challenge 2022 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/kringlecon-2022/blog/atom.xml" title="SANS Holiday Hack Challenge 2022 Atom Feed"><link rel="stylesheet" href="/kringlecon-2022/assets/css/styles.45ced71f.css">
<link rel="preload" href="/kringlecon-2022/assets/js/runtime~main.456322f3.js" as="script">
<link rel="preload" href="/kringlecon-2022/assets/js/main.3126dbbc.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/kringlecon-2022/"><div class="navbar__logo"><img src="/kringlecon-2022/img/liftarn-Santa-skull.svg" alt="kringlecon-2022 logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/kringlecon-2022/img/liftarn-Santa-skull.svg" alt="kringlecon-2022 logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">SANS Holiday Hack Challenge 2022</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/kringlecon-2022/">Write up</a></div><div class="navbar__items navbar__items--right"><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/kringlecon-2022/category/objectives">Objectives</a><button aria-label="Toggle the collapsible sidebar category &#x27;Objectives&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kringlecon-2022/">Foreword</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kringlecon-2022/writeup/KringleCon Orientation">Kringlecon Orientation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/kringlecon-2022/category/recover-tolkien-ring">Recover Tolkien Ring</a><button aria-label="Toggle the collapsible sidebar category &#x27;Recover Tolkien Ring&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/kringlecon-2022/writeup/TolkienRing/wireshark_practice">Wireshark Practice</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/kringlecon-2022/writeup/TolkienRing/windows_event_logs">Windows Event Logs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/kringlecon-2022/writeup/TolkienRing/suricata_regatta">Suricata Regatta</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/kringlecon-2022/category/recover-elfen-ring">Recover Elfen Ring</a><button aria-label="Toggle the collapsible sidebar category &#x27;Recover Elfen Ring&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/kringlecon-2022/category/recover-web-ring">Recover Web Ring</a><button aria-label="Toggle the collapsible sidebar category &#x27;Recover Web Ring&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/kringlecon-2022/category/recover-cloud-ring">Recover Cloud Ring</a><button aria-label="Toggle the collapsible sidebar category &#x27;Recover Cloud Ring&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/kringlecon-2022/category/recover-the-burning-ring-of-fire">Recover the Burning Ring of Fire</a><button aria-label="Toggle the collapsible sidebar category &#x27;Recover the Burning Ring of Fire&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kringlecon-2022/writeup/finale">Finale</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/kringlecon-2022/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/kringlecon-2022/category/objectives"><span itemprop="name">Objectives</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/kringlecon-2022/category/recover-tolkien-ring"><span itemprop="name">Recover Tolkien Ring</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Wireshark Practice</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Wireshark Practice</h1><blockquote><p>Use the Wireshark Phishing terminal in the Tolkien Ring to solve the mysteries around the <a href="https://storage.googleapis.com/hhc22_player_assets/suspicious.pcap" target="_blank" rel="noopener noreferrer">suspicious PCAP</a>. Get hints for this challenge by typing <code>hint</code> in the upper panel of the terminal.</p></blockquote><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="questions">Questions<a class="hash-link" href="#questions" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="this-all-started-when-i-clicked-on-a-link-in-my-email-can-you-help-me">This all started when I clicked on a link in my email. Can you help me?<a class="hash-link" href="#this-all-started-when-i-clicked-on-a-link-in-my-email-can-you-help-me" title="Direct link to heading">​</a></h3><p>The questions for this game is presented through a Cranberry terminal - but the associated PCAP can be downloaded and analyzed separately by the player. For the first question the player has to type <strong>&quot;yes&quot;</strong> in the upper terminal split. It doesn&#x27;t actually matter what the player enters, though, as I typed <strong>&quot;Old McDonald had a Pharm&quot;</strong>:</p><p><img loading="lazy" alt="Use the terminal" src="/kringlecon-2022/assets/images/wireshark-terminal-143c62f501dedeb0fc9cce7687503dee.png" width="781" height="572" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="there-are-objects-in-the-pcap-file-that-can-be-exported-by-wireshark-andor-tshark-what-type-of-objects-can-be-exported-from-this-pcap">There are objects in the PCAP file that can be exported by Wireshark and/or Tshark. What type of objects can be exported from this PCAP?<a class="hash-link" href="#there-are-objects-in-the-pcap-file-that-can-be-exported-by-wireshark-andor-tshark-what-type-of-objects-can-be-exported-from-this-pcap" title="Direct link to heading">​</a></h3><p>Wireshark has built in functionality to dump objects found in a PCAP. For this objective I opened the &quot;File -&gt; Export Objects&quot; window:</p><p><img loading="lazy" alt="Wireshark 1" src="/kringlecon-2022/assets/images/wireshark-1-fd2a906a3a8a3ec3cebc389e2ec16bfa.png" width="751" height="590" class="img_ev3q"></p><p>Which displayed a short object list: </p><p><img loading="lazy" alt="Wireshark 2" src="/kringlecon-2022/assets/images/wireshark-2-88524a291371648a0688e0d6abb02605.png" width="746" height="551" class="img_ev3q"></p><p>The objects that can be exported from this PCAP is of the <strong>HTTP</strong> kind.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-the-name-of-the-largest-file-we-can-export">What is the name of the largest file we can export?<a class="hash-link" href="#what-is-the-name-of-the-largest-file-we-can-export" title="Direct link to heading">​</a></h3><p>Still in the object list, the player can simply sort the list by &quot;Size&quot; column to find the largest file (or just find it manually since the list is so small - which I did). In this case it would be <strong>&quot;app.php&quot;</strong> (808 kB):</p><p><img loading="lazy" alt="Wireshark 2" src="/kringlecon-2022/assets/images/wireshark-2-88524a291371648a0688e0d6abb02605.png" width="746" height="551" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-packet-number-starts-that-appphp-file">What packet number starts that app.php file?<a class="hash-link" href="#what-packet-number-starts-that-appphp-file" title="Direct link to heading">​</a></h3><p>Still in the object list, the player can simply look at the &quot;Packet&quot; column to determine the packet number. In this case it would be <strong>&quot;687&quot;</strong>:</p><p><img loading="lazy" alt="Wireshark 2" src="/kringlecon-2022/assets/images/wireshark-2-88524a291371648a0688e0d6abb02605.png" width="746" height="551" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-the-ip-of-the-apache-server">What is the IP of the Apache server?<a class="hash-link" href="#what-is-the-ip-of-the-apache-server" title="Direct link to heading">​</a></h3><p>The player can go directly to the packet from last question by &quot;Wireshark -&gt; Go -&gt; Go To Packet&quot; and enter the packet number:</p><p><img loading="lazy" alt="Wireshark finding Apache IP" src="/kringlecon-2022/assets/images/wireshark-finding-apache-ip-628290c837737939e215ad2a503c4295.png" width="976" height="823" class="img_ev3q"></p><p>Which will yield the answer, <strong>&quot;192.185.57.242&quot;</strong>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-file-is-saved-to-the-infected-host">What file is saved to the infected host<a class="hash-link" href="#what-file-is-saved-to-the-infected-host" title="Direct link to heading">​</a></h3><p>The player can solve this problem by saving the <strong>&quot;app.php&quot;</strong> file locally from this dialog (same as in &quot;What is the name of the largest file we can export?&quot;): </p><p><img loading="lazy" alt="Wireshark 2" src="/kringlecon-2022/assets/images/wireshark-2-88524a291371648a0688e0d6abb02605.png" width="746" height="551" class="img_ev3q"></p><p>Then opening the <strong>&quot;app.php&quot;</strong> file in a text editor, say Sublime which I dids. In this file there is a reference to a file:</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> byteNumbers </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">Array</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">byteCharacters</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> i </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> i </span><span class="token operator">&lt;</span><span class="token plain"> byteCharacters</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> i</span><span class="token operator">++</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        byteNumbers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> byteCharacters</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">charCodeAt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> byteArray </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">Uint8Array</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">byteNumbers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// now that we have the byte array, construct the blob from it</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> blob1 </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">Blob</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">byteArray</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token literal-property property">type</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;application/octet-stream&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">saveAs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">blob1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Ref_Sept24-2020.zip&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token plain">script</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token plain">body</span><span class="token operator">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Filename <strong>&quot;Ref_Sept24-2020.zip&quot;</strong> is the answer to the question.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="attackers-used-bad-tls-certificates-in-this-traffic-which-countries-were-they-registered-to-submit-the-names-of-the-countries-in-alphabetical-order-separated-by-a-commas-ex-norway-sout-korea">Attackers used bad TLS certificates in this traffic. Which countries were they registered to? Submit the names of the countries in alphabetical order separated by a commas (Ex: Norway, Sout Korea).<a class="hash-link" href="#attackers-used-bad-tls-certificates-in-this-traffic-which-countries-were-they-registered-to-submit-the-names-of-the-countries-in-alphabetical-order-separated-by-a-commas-ex-norway-sout-korea" title="Direct link to heading">​</a></h3><p>To find bad TLS certificates the player can base the investigation around the following filter:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">tls.handshake.type </span><span class="token operator">==</span><span class="token plain"> </span><span class="token number">11</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This returns a few entries:</p><p><img loading="lazy" alt="Wireshark TLS" src="/kringlecon-2022/assets/images/wireshark-tls-e0d77e3b9a4105232c38589a9bbe6f9f.png" width="962" height="796" class="img_ev3q"></p><p>For each certificate entry the player should locate the &quot;RDNSequence&quot; section. Inside this section the player will find a CountryName field. Player should make note of each CountryName, like this: </p><table><thead><tr><th>Country Code</th><th>Country</th></tr></thead><tbody><tr><td>IE</td><td>Ireland</td></tr><tr><td>IL</td><td>Israel</td></tr><tr><td>SS</td><td>South Sudan</td></tr><tr><td>US</td><td>United States</td></tr></tbody></table><p>From this table it is trivial to find the answer once each country code has been translated, Answer is <strong>Ireland, Israel, South Sudan</strong></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="is-the-host-infected-yesno">Is the host infected (Yes|No)<a class="hash-link" href="#is-the-host-infected-yesno" title="Direct link to heading">​</a></h3><p>Everything points to the host being infected, so the player should answer <strong>yes</strong>.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/kringlecon-2022/category/recover-tolkien-ring"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Recover Tolkien Ring</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/kringlecon-2022/writeup/TolkienRing/windows_event_logs"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Windows Event Logs</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#questions" class="table-of-contents__link toc-highlight">Questions</a><ul><li><a href="#this-all-started-when-i-clicked-on-a-link-in-my-email-can-you-help-me" class="table-of-contents__link toc-highlight">This all started when I clicked on a link in my email. Can you help me?</a></li><li><a href="#there-are-objects-in-the-pcap-file-that-can-be-exported-by-wireshark-andor-tshark-what-type-of-objects-can-be-exported-from-this-pcap" class="table-of-contents__link toc-highlight">There are objects in the PCAP file that can be exported by Wireshark and/or Tshark. What type of objects can be exported from this PCAP?</a></li><li><a href="#what-is-the-name-of-the-largest-file-we-can-export" class="table-of-contents__link toc-highlight">What is the name of the largest file we can export?</a></li><li><a href="#what-packet-number-starts-that-appphp-file" class="table-of-contents__link toc-highlight">What packet number starts that app.php file?</a></li><li><a href="#what-is-the-ip-of-the-apache-server" class="table-of-contents__link toc-highlight">What is the IP of the Apache server?</a></li><li><a href="#what-file-is-saved-to-the-infected-host" class="table-of-contents__link toc-highlight">What file is saved to the infected host</a></li><li><a href="#attackers-used-bad-tls-certificates-in-this-traffic-which-countries-were-they-registered-to-submit-the-names-of-the-countries-in-alphabetical-order-separated-by-a-commas-ex-norway-sout-korea" class="table-of-contents__link toc-highlight">Attackers used bad TLS certificates in this traffic. Which countries were they registered to? Submit the names of the countries in alphabetical order separated by a commas (Ex: Norway, Sout Korea).</a></li><li><a href="#is-the-host-infected-yesno" class="table-of-contents__link toc-highlight">Is the host infected (Yes|No)</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Roger C.B. Johnsen. Built with Sticks, stone, rubber bands and glue.</div></div></div></footer></div>
<script src="/kringlecon-2022/assets/js/runtime~main.456322f3.js"></script>
<script src="/kringlecon-2022/assets/js/main.3126dbbc.js"></script>
</body>
</html>